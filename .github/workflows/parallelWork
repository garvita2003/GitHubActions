name: Matrix Runner Workflow
 
on: [push]
 
jobs:
  job-a:
    name: Job-A on ${{ matrix.runner }}
    runs-on: [self-hosted, ${{ matrix.runner }}]
    strategy:
      matrix:
        runner: [runner-a, runner-b]
    outputs:
      runner-a-status: ${{ steps.set-result.outputs.runner-a }}
      runner-b-status: ${{ steps.set-result.outputs.runner-b }}
    steps:
      - name: Run Job-A logic
        run: echo "Running Job-A on ${{ matrix.runner }}"
 
      - name: Set result
        id: set-result
        run: |
          echo "${{ matrix.runner }}=success" >> $GITHUB_OUTPUT
 
  job-b:
    name: Job-B on ${{ matrix.runner }}
    needs: job-a
    runs-on: [self-hosted, ${{ matrix.runner }}]
    strategy:
      matrix:
        runner: [runner-a, runner-b]
    if: |
      (matrix.runner == 'runner-a' && needs.job-a.outputs.runner-a-status == 'success') ||
      (matrix.runner == 'runner-b' && needs.job-a.outputs.runner-b-status == 'success')
    steps:
      - run: echo "Running Job-B on ${{ matrix.runner }} because Job-A succeeded on the same runner"
